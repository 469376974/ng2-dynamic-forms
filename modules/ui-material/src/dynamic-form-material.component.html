<div [formGroup]="controlGroup" [ngClass]="model.cls.element.container">

    <label *ngIf="!(model.type === 'CHECKBOX') && model.label"
           [attr.for]="model.id"
           [innerHTML]="model.label"
           [ngClass]="model.cls.element.label"></label>


    <fieldset *ngIf="model.type === 'GROUP' || model.type === 'CHECKBOX_GROUP'"
              [dynamicId]="bindId && model.id"
              [formGroupName]="model.id"
              [name]="model.name"
              [ngClass]="[model.cls.element.control, model.cls.grid.control]">

        <legend *ngIf="model.legend" [innerHTML]="model.legend"></legend>

        <dynamic-form-material-control *ngFor="let controlModel of model.group"
                                       [controlGroup]="control"
                                       [model]="controlModel"
                                       [nestedTemplate]="customTemplate"
                                       (blur)="onFocusChange($event)"
                                       (change)="onValueChange($event)"
                                       (focus)="onFocusChange($event)"></dynamic-form-material-control>
    </fieldset>


    <div *ngIf="model.type === 'ARRAY'"
         [dynamicId]="bindId && model.id"
         [formArrayName]="model.id"
         [ngClass]="[model.cls.element.control, model.cls.grid.control]">

        <fieldset *ngFor="let groupModel of model.groups; let idx = index" [formGroupName]="idx">

            <dynamic-form-material-control *ngFor="let controlModel of groupModel.group"
                                           [bindId]="false"
                                           [controlGroup]="control.at(idx)"
                                           [model]="controlModel"
                                           [nestedTemplate]="nestedTemplate"
                                           (blur)="onFocusChange($event)"
                                           (change)="onValueChange($event)"
                                           (focus)="onFocusChange($event)"></dynamic-form-material-control>

            <template [ngTemplateOutlet]="customTemplate || nestedTemplate"
                      [ngOutletContext]="groupModel"></template>

        </fieldset>

    </div>


    <md-checkbox *ngIf="model.type === 'CHECKBOX'"
                 [align]="model.align"
                 [checked]="model.checked"
                 [disabled]="model.disabled"
                 [dynamicId]="bindId && model.id"
                 [formControlName]="model.id"
                 [indeterminate]="model.indeterminate"
                 [name]="model.name"
                 [ngClass]="model.cls.element.control"
                 (blur)="onFocusChange($event)"
                 (change)="onValueChange($event)"
                 (focus)="onFocusChange($event)"><span [innerHTML]="model.label"></span></md-checkbox>


    <md-input *ngIf="model.type === 'INPUT'"
              [autocomplete]="model.autoComplete"
              [autofocus]="model.autoFocus"
              [dynamicId]="bindId && model.id"
              [formControlName]="model.id"
              [hintLabel]="model.help"
              [list]="model.listId"
              [max]="model.max"
              [maxlength]="model.maxLength"
              [min]="model.min"
              [minlength]="model.minLength"
              [name]="model.name"
              [ngClass]="model.cls.element.control"
              [pattern]="model.pattern"
              [placeholder]="model.placeholder"
              [readonly]="model.readOnly"
              [required]="model.required"
              [spellcheck]="model.spellCheck"
              [step]="model.step"
              [tabindex]="model.tabIndex"
              [type]="model.inputType"
              (blur)="onFocusChange($event)"
              (change)="onValueChange($event)"
              (focus)="onFocusChange($event)">

        <span *ngIf="model.prefix" md-prefix [innerHTML]="model.prefix"></span>
        <span *ngIf="model.suffix" md-suffix [innerHTML]="model.suffix"></span>

    </md-input>


    <md-radio-group *ngIf="model.type === 'RADIO_GROUP'"
                    [disabled]="model.disabled"
                    [dynamicId]="bindId && model.id"
                    [formControlName]="model.id"
                    [name]="model.name"
                    [ngClass]="model.cls.element.control"
                    (blur)="onFocusChange($event)"
                    (change)="onValueChange($event)"
                    (focus)="onFocusChange($event)">

        <md-radio-button *ngFor="let option of model.options"
                         [name]="model.name"
                         [value]="option.value"><span [innerHTML]="option.label"></span></md-radio-button>

    </md-radio-group>


    <md-slide-toggle *ngIf="model.type === 'SWITCH'"
                     [checked]="model.checked"
                     [disabled]="model.disabled"
                     [dynamicId]="bindId && model.id"
                     [formControlName]="model.id"
                     [name]="model.name"
                     [ngClass]="model.cls.element.control"
                     (change)="onValueChange($event)">

        <span *ngIf="!model.checked" [innerHTML]="model.offLabel"></span>
        <span *ngIf="model.checked" [innerHTML]="model.onLabel"></span>

    </md-slide-toggle>


    <md-textarea *ngIf="model.type === 'TEXTAREA'"
                 [attr.tabindex]="model.tabIndex"
                 [dynamicId]="bindId && model.id"
                 [cols]="model.cols"
                 [formControlName]="model.id"
                 [maxlength]="model.maxLength"
                 [minlength]="model.minLength"
                 [name]="model.name"
                 [ngClass]="model.cls.element.control"
                 [placeholder]="model.placeholder"
                 [readonly]="model.readOnly"
                 [required]="model.required"
                 [rows]="model.rows"
                 [spellcheck]="model.spellCheck"
                 [wrap]="model.wrap"
                 (blur)="onFocusChange($event)"
                 (change)="onValueChange($event)"
                 (focus)="onFocusChange($event)"></md-textarea>

    <ng-content></ng-content>

</div>